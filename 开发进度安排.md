# 开发进度安排

## 总体里程碑
- 迭代长度：每迭代1-2周；每迭代需交付可运行与可测试的增量。
- M0（已完成）：Monorepo初始化、前端骨架与表格原型、Excel导入/导出。
- M1：标签页视图与保护视图抽屉、工具栏占位、字段配置UI、服务端契约草案与MSW对齐。
- M2：筛选/排序/分页（前端UI+Mock）、条件填色、行高、表头菜单与约束、键盘操作与批量粘贴。
- M3：后端与数据库（Prisma建模、CRUD、服务端筛选排序分页、附件上传）、鉴权与分享链接。
- M4：实时协同（WS推送、光标、评论）、审计与版本、权限最小集（视图/表级）。
- M5：全文检索与索引优化；E2E覆盖主要业务流；性能基准（pgBench）。

## 迭代计划（建议6迭代）
- Iteration 1（侧边栏+视图基础，5-7天）
  - 侧边栏层级导航与路由；视图标签页与“···”菜单；保护视图抽屉交互。
  - 工具栏占位与交互框架；共享类型包与OpenAPI草案；MSW场景。
  - DoD：UI交互齐备、Mock驱动；Vitest+RTL用例通过；Playwright标签页流转脚本通过。
- Iteration 2（表格能力增强，7-10天）
  - 字段配置弹窗与抽屉；筛选条件构建器；排序UI；行高控制；条件填色（24色、作用域）。
  - 表头菜单全集与约束；批量粘贴、基础键盘操作、冻结列。
  - DoD：组件测试覆盖主要交互；E2E脚本通过；无严重性能回退。
- Iteration 3（后端基础，7-10天）
  - Express+TS+Prisma脚手架；Schema建模与迁移；CRUD与分页/筛选/排序；附件上传（本地存储+校验）。
  - 登录与会话；分享链接只读；API文档发布。
  - DoD：Supertest用例覆盖CRUD与查询；testcontainers隔离；前端联通真实API（保留MSW fallback）。
- Iteration 4（协同与权限，7-10天）
  - WebSocket通道；光标与评论；乐观更新与版本冲突策略；审计日志。
  - 权限最小集（表/视图级）；保护视图后端落地。
  - DoD：并发场景E2E脚本通过；审计可查询；权限用例通过。
- Iteration 5（检索与优化，5-7天）
  - 全文/模糊搜索；索引与性能调优；复杂筛选组合。
  - DoD：pgBench基准达标；搜索与筛选接口P95≤200ms。
- Iteration 6（收尾与生产化，5-7天）
  - 仪表盘/收集表/文档/文件夹的MVP占位与基本功能；CI管线完善；文档打磨。
  - DoD：CI全绿、文档齐全、部署脚本可复现。

## 每日ToDo模板（执行与落地）
- 需求拆解与验收标准列项
- 开发任务（模块/文件/接口/交互）
- 测试任务（单元/组件/集成/E2E）
- 风险与阻塞（含缓解方案）
- 进度实际（完成/在做/待办）与燃尽

## 验收与里程碑输出
- 每迭代结束必须输出：
  - 进度报告（完成清单、偏差说明、下迭代目标）
  - 测试报告（覆盖率、缺陷列表、关键用例截图/视频）
  - 变更日志与接口文档更新

## 依赖与准备
- Docker用于testcontainers；PostgreSQL本地或容器；GitHub Actions权限。
- 环境变量：`.env`（数据库、JWT、存储路径等）。